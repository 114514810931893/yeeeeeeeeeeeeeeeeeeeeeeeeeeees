<!DOCTYPE html>
<html lang="ja">
<!-- とりあえずなんかコンソールで言われたから貼っとくピクミン -->
<!-- ページの読み込みが完了する前にレイアウトの開始が強制されました。スタイルシートがまだ読み込まれていない場合、スタイル付けされていないコンテンツがちらつく原因となる可能性があります。 -->
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TCHO TERMINAL</title>
<style>
	/* 変数って意味あんのかな */
    :root {
        --base-font: 'Consolas', 'Courier New', monospace;
        --color-blue: #00aaff;
        --color-blue-dark: #0d1e2e;
        --color-blue-light: #a8d8f0;
        --color-white: #f0f8ff;
        --color-black: #1a1a2e;
        --color-green: #00ff7f;
        --color-green-dark: #022c15;
    }
	/* 覚えてない、たぶん背景色とか決めるやつ。全体設定 */
    * { box-sizing: border-box; }
    body {
        font-family: var(--base-font);
        background-color: var(--color-white);
        color: var(--color-black);
        margin: 0; padding: 0;
        width: 100vw; height: 100vh;
        overflow: hidden;
        cursor: default;
        transition: background-color 0.5s ease-in-out, color 0.5s ease-in-out;
    }
    body::after {
        content: ''; position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: radial-gradient(ellipse at center, rgba(0,0,0,0) 50%, rgba(0,0,0,0.3) 100%);
        pointer-events: none;
        z-index: 9999;
        transition: opacity 0.5s;
    }
    .hidden { display: none !important; opacity: 0 !important; visibility: hidden !important; }

    /* --- 起動アニメーしょん --- */
    .sequence-container {
        width: 100%; height: 100%;
        display: flex; justify-content: center; align-items: center;
        flex-direction: column; position: absolute;
        top: 0; left: 0;
        padding-bottom: 8rem; 
    }
    #ideology { position: absolute; bottom: 2rem; left: 50%; transform: translateX(-50%); width: 100%; text-align: center; font-size: 1.1rem; opacity: 0; transition: opacity 1s ease-in-out; }
    #title { font-family: var(--base-font); font-size: 4.5rem; color: var(--color-black); text-shadow: none; letter-spacing: 2px; font-weight: bold; opacity: 0; transition: opacity 2s ease-in-out; }
    #access-level { font-size: 3rem; font-weight: bold; opacity: 0; transform: scale(1.1); transition: opacity 0.5s, transform 0.5s; }
    #password-window { background: var(--color-blue-dark); padding: 2rem 4rem; border-radius: 4px; color: var(--color-white); text-align: center; opacity: 0; transform: scaleY(0); transition: opacity 0.3s ease-in-out, color 0.5s ease-in-out; }
    #password-window.open { animation: window-open 0.5s forwards; }
    #password-window.close { animation: window-close 0.3s forwards; }
    @keyframes window-open { 0% { transform: scaleX(0) scaleY(0.01); opacity: 0; } 50% { transform: scaleX(1) scaleY(0.01); opacity: 1; } 100% { transform: scaleX(1) scaleY(1); opacity: 1; } }
    @keyframes window-close { 0% { transform: scaleY(1); opacity: 1; } 100% { transform: scaleY(0); opacity: 0; } }
    #password-window p { font-size: 1.5rem; letter-spacing: 2px; margin: 0 0 1rem 0; transition: color 0.3s ease-in-out; }
    #password-squares { display: flex; gap: 0.5rem; }
    .square { width: 2rem; height: 2rem; border: 2px solid var(--color-white); transition: background-color 0.1s ease-in-out, border-color 0.3s ease-in-out; }
    .square.filled { background-color: var(--color-white); }
    .square.accepted { background-color: var(--color-blue-light); border-color: var(--color-blue-light); }
    #typewriter { font-size: 2rem; opacity: 0; transition: opacity 0.5s; }

    /* --- メインUI 背景 --- */
    body.main-ui { background-color: rgba(26, 26, 46, 0.9); color: var(--color-white); --current-fg: var(--color-green); }
    body.main-ui::after { opacity: 0; }
    #background-layer-z {
        position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
        z-index: -1; opacity: 0; color: #4a5c6c; padding: 2rem;
        display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 2rem; font-size: 0.9rem;
        overflow: hidden; /* transition set by JS */
    }
	.z-panel { height:600px; color:#ced5db; }
    #background-layer-z .z-panel { background: rgba(13, 30, 46, 0.2); padding: 1rem; border-left: 2px solid var(--color-blue-dark); }
    #background-layer-z h3 { color: var(--color-blue-light); margin: 0 0 0.5rem 0; border-bottom: 1px solid var(--color-blue-dark); padding-bottom: 0.25rem; }
    #background-layer-z p { margin: 0.5rem 0; line-height: 1.6; }
    #background-layer-z strong { color: #88a8c4; }
    .main-grid { 
        display: grid; grid-template-columns: 280px 1fr 280px; 
        grid-template-rows: 60px 1fr 80px; 
        width: 100%; height: 100%; 
        padding: 0.5rem; opacity: 0; 
        box-shadow: inset 0 0 150px rgba(0,0,0,0.7);
    }
    .grid-item { padding: 0.25rem; }
    .top-left { grid-area: 1 / 1 / 2 / 2; font-size: 0.9rem; }
    #clock-date { color: var(--current-fg); }
    #clock-time { font-size: 1.7rem; }
    .top-center { grid-area: 1 / 2 / 2 / 3; display: flex; justify-content: center; align-items: center; flex-direction: column; position: relative; }
    #search-bar { width: 80%; background: var(--color-green-dark); border: 1px solid var(--current-fg); color: var(--current-fg); padding: 0.5rem 1rem; font-family: var(--base-font); font-size: 1rem; }
    #search-bar:focus { outline: none; box-shadow: 0 0 5px var(--current-fg); }
    #search-results { position: absolute; top: 100%; width: 80%; background: rgba(2, 44, 21, 0.95); border: 1px solid var(--current-fg); border-top: none; max-height: 300px; overflow-y: auto; z-index: 1000; }
    .search-result-item { padding: 0.5rem 1rem; cursor: pointer; }
    .search-result-item:hover { background: var(--current-fg); color: var(--color-black); }
    .top-right { grid-area: 1 / 3 / 2 / 4; text-align: right; }
    .top-right h2 { margin: 0; font-size: 1.2rem; color: var(--current-fg); }
    .top-right p { margin: 0; font-size: 0.8rem; line-height: 1.4; }
    .top-right .read-only { color: var(--color-blue-light); }
    .top-right .session-info { margin-top: 0.5rem; color: #88a8c4; font-size: 0.8rem; }
    .top-right .session-info span { color: var(--color-white); }
    .panel-divider { border: 0; border-top: 1px solid var(--color-green-dark); margin: 0.5rem 0; }
    #client-metadata { text-align: left; }
    #client-metadata p { font-size: 0.7rem; line-height: 1.2; word-break: break-all; }
    #client-metadata span { color: var(--current-fg); }
    .main-left { grid-area: 2 / 1 / 3 / 2; display: flex; flex-direction: column; }
    .parallelograms { margin-top: 1rem; margin-bottom: 2rem; }
    .parallelogram { position: relative; width: 80%; height: 15px; background-color: var(--color-green-dark); border: 1px solid var(--current-fg); margin-bottom: 8px; transform: skewX(-20deg); transition: all 0.3s ease-out; display: flex; align-items: center; justify-content: center; }
    .parallelogram .grade-text { color: var(--color-black); font-size: 0.7rem; font-weight: bold; transform: skewX(20deg); opacity: 0; transition: opacity 0.3s; }
    .parallelogram.highlighted { background-color: var(--color-white); transform: skewX(-20deg) translateX(20px); }
    .parallelogram.highlighted .grade-text { opacity: 1; }
    .input-group { margin-bottom: 0.75rem; font-size: 0.9rem; }
    .input-group label { display: block; color: var(--current-fg); margin-bottom: 0.25rem; font-size: 0.8rem; }
    .input-group input { width: 100%; padding: 0.3rem; background: var(--color-white); border: 1px solid var(--color-black); font-family: var(--base-font); }

	/* これ未使用な気がする */
	/* ちゃんと使いました！(2025/07/23) */
    #binary-scroller-container { margin-top: 1.5rem; }
    #binary-scroller {
        height: 80px;
        background: var(--color-green-dark);
        border: 1px solid var(--current-fg);
        color: var(--current-fg);
        font-size: 0.8rem;
        padding: 0.25rem;
        overflow: hidden;
        white-space: pre;
        word-break: break-all;
        line-height: 1.2;
    }
    
    .main-center { grid-area: 2 / 2 / 3 / 3; }
    #workspace { width: 100%; height: 100%; background: var(--color-white); color: var(--color-black); border: 2px solid var(--current-fg); padding: 1rem; overflow: auto; }
    #workspace pre { white-space: pre-wrap; word-wrap: break-word; margin: 0; font-family: var(--base-font); font-size: 1.2rem; }
    #workspace iframe { width: 100%; height: 100%; border: none; }
    
    .bottom-left { 
        grid-area: 3 / 1 / 4 / 2; 
        align-self: end; 
        font-size: 0.7rem; 
        line-height: 1.3;
        position: relative;
        overflow: hidden;
    }
    .bottom-left p { margin: 0; position: relative; z-index: 1; padding: 0 2px; }
    .bottom-left p span { color: var(--current-fg); }
    #numeric-background {
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        z-index: 0;
        font-size: 0.8rem;
        line-height: 1;
        color: rgba(0, 255, 127, 0.1);
        word-break: break-all;
        user-select: none;
        pointer-events: none;
    }
    #hello-msg { margin-top: 1rem !important; font-size: 1.2rem; color: var(--current-fg); }
    .bottom-center { grid-area: 3 / 2 / 4 / 3; display: flex; justify-content: center; align-items: center; }
    .dock { display: flex; gap: 5px; height: 100%; align-items: flex-end; }
    .dock-item { position: relative; width: 8px; height: 30px; background-color: var(--color-green-dark); border: 1px solid var(--current-fg); cursor: pointer; transition: all 0.2s ease-in-out; }
    .dock-item:hover { width: 30px; background-color: var(--current-fg); }
    .dock-item::before { content: attr(data-filename); position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%); background-color: var(--color-black); border: 1px solid var(--current-fg); padding: 5px 10px; white-space: nowrap; opacity: 0; visibility: hidden; transition: all 0.2s ease-in-out; }
    .dock-item:hover::before { opacity: 1; visibility: visible; bottom: 150%; }
	#background-layer-z .z-panel:nth-child(4) {
		grid-column: 1 / 3; /* キーカードをのばすやつ、1~4の長さってことかな、CSSgridホンマようわからんので、これ読んでるAIくん説明おなしゃす */
		margin-bottom: 10px;
	}
</style>
</head>
<body>
	<!-- 背景裏人事ファイル -->
    <div id="background-layer-z" class="hidden">
	<!-- 一行目 -->
		<div class="z-panel">
			<h3>人事ファイル抜粋：F-TPD-000 (Rev.1)</h3>
			<p><strong>識別名:</strong> 或いは 夜（あるいは よる）</p>
			<p><strong>役職:</strong> 特務庁長官補佐 兼 筆頭護衛官 (LEVEL-5)</p>
			<p><strong>外見:</strong> 	身長168cm。桜色の長髪を、金のリングで無造作なポニーテールにまとめている。このリングは戦闘時には振り解かれ、彼女の動きに合わせて髪が滝のように流れる。体躯は、贅肉を削ぎ落としたしなやかな筋肉で構成されており、トップアスリートや武術家を思わせる、爆発的な力を内包した機能美を持つ。
	服装は、彼女自身の思想を体現するかのように、複数の組織の象徴を意図的に取り入れた特注品で構成される。頭には金の装飾が施された純白の船長帽（海上部隊の象徴）、胴には対になった白金の翼が刺繍された黒のライダースジャケット（航空部隊の象徴）、そして足元は金の装飾が入った帝国陸軍式の厚底編み上げブーツ（陸上部隊の象徴）を着用。これは、彼女自身が日本の全武装組織の上に立つ存在であるという、無言の示威行為と解釈される。</p>
			<p><strong>性格・特徴:</strong> 		超ド級の楽天家にして戦闘狂。 その行動原理は「面白いか、退屈か」という極めて個人的な価値基準にのみ準拠する。国家存亡の危機を最高のエンターテイメントと捉え、難解な報告書を睡眠導入剤として利用するなど、組織の理念や責務に対する理解は皆無に等しい。
		ラーメンは好物ではあるが、インスタント食品でも満足するなど、食へのこだわりは希薄。彼女の機嫌を左右するのは、食事の質ではなく「退屈の長さ」である。
		公的には長官補佐だが、その実態は橘長官の「操縦者」あるいは**「最終安全装置」**に近い。長官が決断を躊躇した場合、その権限を悪びれもなく代行する。しかし、長官の生命に危険が及ぶ事態においては、文字通り「世界」を敵に回してでも彼を護衛する絶対的な忠誠心を見せる。</p>
			<p><strong>職務評価:</strong> 公的には長官補佐だが、その実態は橘長官の「操縦者」あるいは「制御装置」に近い。長官が決断を躊躇した場合、その権限を悪びれもなく代行する。しかし、長官の生命に危険が及ぶ事態においては、文字通り「世界」を敵に回してでも彼を護衛する絶対的な忠誠心を見せる。彼女の存在は、若き長官の脆弱な精神構造と物理的な安全を担保する、最も効果的かつ最も危険な安全保障システムである。</p>
		</div>      
		<div class="z-panel">
			<h3>特異点 SCAN: LEVEL-5 ANALYSIS</h3>
			<p><strong>【万象把握 / All-Seeing Muscle】</strong><br>
				- <strong>能力概要:</strong> 半径約500m以内の空間に存在する、全ての物理情報をリアルタイムで知覚・インプットする受動的常時発動型特異点。空気の密度、風速、湿度、飛来する弾丸の回転数と減速率、構造物の内部劣化、対象の筋繊維の収縮から予測される次行動まで、あらゆる変数が無意識下で処理される。<br>
				- <strong>観測現象:</strong> 未来予知と酷似した超々高精度の回避・迎撃機動。彼女への物理攻撃は、攻撃者が意図した瞬間には既に「過去の事象」として処理されており、命中する確率は統計上ゼロに収束する。<br>
				- <strong>リスク評価:</strong> 能力発動による精神的負荷は観測されていない。これは後述の「絶頂筋」による肉体的フィードバックが、情報処理による精神的負荷を即座に相殺しているためと推測される。
			</p>
			<p><strong>【絶頂筋 / Climax Muscle】</strong><br>
				- <strong>能力概要:</strong> 筋繊維の密度および収縮効率が、生化学的な理論上の限界値を恒常的に逸脱している。高層ビルを打撃のみで崩壊させ、戦車の主砲弾を正面から受け止めても身体機能に一切の支障をきたさない。<br>
				- <strong>エネルギー源:</strong> この異常な身体機能を維持するため、極めて高いカロリー摂取を必要とする。特に、脂質と塩分、炭水化物を高濃度で含有する「ラーメン」を摂取した際、エネルギー変換効率が最大となることが確認されている。<br>
				- <strong>総合評価:</strong> 「万象把握」による完璧な解答を、「絶頂筋」という絶対的な実行能力で実現する、自己完結した攻防一体のシステム。物理法則下における、生物として到達しうる最強の一個体と結論付ける。
			</p>
		</div>
		<div class="z-panel">
			<h3>内部保安部 監視報告：対象F-TPD-000</h3>
			<p><strong>総合評価:</strong> 制御不能な最終兵器 (Uncontrollable Ultimate Weapon)</p>
			<p><strong>概要:</strong> 対象「或いは 夜」は、特務庁が保有する最大戦力であると同時に、組織の秩序を根底から揺るがす最も危険な不安定要素である。彼女の行動原理は、国家の安寧や組織の理念とは一切無関係な、極めて個人的な「快/不快」の原則にのみ基づく。</p>
			<p><strong>リスク分析:</strong>
			<ul>
				<li style="margin-bottom: 8px;"><strong>長官への依存関係:</strong> 対象は橘長官を「最優先保護対象」であると同時に「私物」と認識。長官の精神的安定が、対象の行動を制御する唯一の枷として機能している。これは、長官自身が組織の最重要人物でありながら、同時に最大の弱点（ヒューマン・デフューズ）となっていることを意味する。</li>
				<li style="margin-bottom: 8px;"><strong>規律の完全無視:</strong> 組織の規律、命令系統、機密保持義務に対する理解は皆無。機密文書をラーメンの汁受けに使用する、最高司令部への出前配達を強行する等の違反行為が常態化しており、その抑止は事実上不可能である。</li>
				<li style="margin-bottom: 8px;"><strong>予測不能な副次被害:</strong> 敵性異常に対する有効性は疑う余地がない。しかし、その機嫌を損ねた際の副次的被害は、準一級異常災害に匹敵する。過去に「不味いラーメン」を理由に発生した空間歪曲事案は、その典型例である。</li>
			</ul>
			</p>
			<p><strong>提言:</strong> 対象への直接的な懲罰・制御の試みは、より大規模な破壊行動を誘発する危険性が極めて高い。現状、橘長官を通じた間接的な宥和（定期的なラーメンの供給、ストレス要因の排除等）が、唯一かつ最も効果的な管理プロトコルであると結論付ける。引き続き、最高レベルでの監視を継続する。</p>
		</div>    
	<!-- 2行目、キーカード -->
		<div class="z-panel" style="height:330px; margin-bottom:160px">
			<h3 style="background-color: #aa33338f; color: #fff; text-align: center; padding: 8px 0; margin: 0 0 15px 0; font-family: 'Lucida Console', 'Courier New', monospace; letter-spacing: 3px; border-bottom: 2px solid #FFD700;">
				TCHO LEVEL-5 SECURITY CLEARANCE
			</h3>
			<DIV STYLE="DISPLAY:FLEX;">
				<div>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0; ">
						<strong style="color: #888; display: inline-block; width: 180px;">AFFILIATION:</strong> <br>Special Service Agency / Top Priority Division
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0 15px 0;">
						<strong style="color: #888; display: inline-block; width: 180px;">ID CODE:</strong> <br>TCHO.Aruiha-Yoru
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0;  margin-top:20px; border-top: 1px solid;">
						<strong style="color: #aaa; display: inline-block; width: 180px;">NAME:</strong> ARUIWA, Yoru
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0 15px 0;">
						<strong style="color: #888; display: inline-block; width: 180px;">FILE CODE:</strong> F-TCHO-000
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0 15px 0;">
						<strong style="color: #888; display: inline-block; width: 180px;">ROLE:</strong> AIDE
					</p>	
				</div>
				
				<hr style="border: 1px solid; border-top: 1px dashed #555; margin-right: 22.5px; margin-left: 22.5px;">
				
				<div style="font-size:0.8rem;">
					<p style="color: #fff; font-family: 'Arial', sans-serif; margin: 8px 0;">
						<strong style="color: #aaa; display: inline-block; width: 220px;">CLEARANCE LEVEL:</strong> <span style="color: #ff4d4d; font-weight: bold; text-shadow: 0 0 5px #ff0000;"> <br>5 [ALL-DOMAIN ACCESS]</span>
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0;">
						<strong style="color: #888; display: inline-block; width: 220px;">ISSUING AUTHORITY:</strong> <br>TCHO SUPERVISORY COUNCIL
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0;">
						<strong style="color: #888; display: inline-block; width: 220px;">DATE OF ISSUE:</strong> <br>1998/04/01
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0; margin-top:2px;">
						<strong style="color: #888; display: inline-block; width: 220px;">EXPIRATION:</strong> <br>UNTIL REVOKED
					</p>
					<p style="color: #ddd; font-family: 'Arial', sans-serif; margin: 8px 0; margin-top:2px;">
						<strong style="color: #888; display: inline-block; width: 220px;">STATUS:</strong> <br>ACTIVE
					</p>
				</div>
				
				<hr style="border: 1px solid; border-top: 1px dashed #555; margin-right: 12.5px; margin-left: 42.5px;">
				
				<div>
					<p><strong>CARD META-DATA:</strong>
					<br>- CARD-ID: <strong>314159265</strong> 
					<br>- APPROVER: <strong>███████████</strong>
					<br>- <strong>[最終対処命令]</strong>の長官権限代行を承認。
					</p>
				</div>
			</DIV>
		</div>

		<div class="z-panel" style="opacity:0.8; height:330px; margin-bottom:160px;">
            <h3 style="margin-bottom: 10px; border-bottom: 1px solid #4a5c6c; padding-bottom: 5px; color: #a8d8f0;">対応事案（抜粋）</h3>
			
			<!-- 1行目: 円周率 (π = 3.1415926535...) -->
			<div style="border-bottom: 1px solid #2c2e40; display:flex; justify-content: space-around; padding-bottom: 5px; margin-bottom: 5px;">
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2014/01/05</p><span style="font-size: 0.9em;"><STRONG>SAC-2014-1-05-92</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2006/05/03</p><span style="font-size: 0.9em;"><STRONG>SAC-2006-5-03-58</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2009/07/09</p><span style="font-size: 0.9em;"><STRONG>SAC-2009-7-09-32</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2003/08/04</p><span style="font-size: 0.9em;"><STRONG>SAC-2003-8-04-62</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2006/04/03</p><span style="font-size: 0.9em;"><STRONG>SAC-2006-4-03-38</STRONG></span></div>
			</div>

			<!-- 2行目: 黄金比 (φ = 1.6180339887...) -->
			<div style="border-bottom: 1px solid #2c2e40; display:flex; justify-content: space-around; padding-bottom: 5px; margin-bottom: 5px;">
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2016/01/08</p><span style="font-size: 0.9em;"><STRONG>SAC-2016-1-08-03</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2003/09/08</p><span style="font-size: 0.9em;"><STRONG>SAC-2003-9-08-87</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2004/09/03</p><span style="font-size: 0.9em;"><STRONG>SAC-2004-9-03-75</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2010/05/08</p><span style="font-size: 0.9em;"><STRONG>SAC-2010-5-08-20</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2009/01/09</p><span style="font-size: 0.9em;"><STRONG>SAC-2009-1-09-51</STRONG></span></div>
			</div>

			<!-- 3行目: ネイピア数 (e = 2.7182818284...) -->
			<div style="border-bottom: 1px solid #2c2e40; display:flex; justify-content: space-around; padding-bottom: 5px; margin-bottom: 5px;">
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2007/01/08</p><span style="font-size: 0.9em;"><STRONG>SAC-2007-1-08-28</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2018/02/08</p><span style="font-size: 0.9em;"><STRONG>SAC-2018-2-08-45</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2009/00/04</p><span style="font-size: 0.9em;"><STRONG>SAC-2009-4-05-90</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2015/02/03</p><span style="font-size: 0.9em;"><STRONG>SAC-2015-2-03-51</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2006/02/08</p><span style="font-size: 0.9em;"><STRONG>SAC-2006-2-08-21</STRONG></span></div>
			</div>

			<!-- 4行目: 2の平方根 (√2 = 1.4142135623...) -->
			<div style="display:flex; justify-content: space-around;">
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2014/01/04</p><span style="font-size: 0.9em;"><STRONG>SAC-2014-1-04-21</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2003/05/06</p><span style="font-size: 0.9em;"><STRONG>SAC-2003-5-06-23</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2007/03/01</p><span style="font-size: 0.9em;"><STRONG>SAC-2007-3-01-04</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2008/01/00</p><span style="font-size: 0.9em;"><STRONG>SAC-2008-1-12-05</STRONG></span></div>
				<div style="border-left: 2px solid #85afd5; padding: 0 8px; text-align: center;"><p style="margin: 2px 0; font-size: 0.8em; color: #ced5db;">2011/02/01</p><span style="font-size: 0.9em;"><STRONG>SAC-2011-2-01-52</STRONG></span></div>
			</div>
        </div>
		<!-- 年: 200 + 定数の1桁目 -->
		<!-- 月: 定数の2桁目と3桁目（ただし12以下になるように調整） -->
		<!-- 日: 定数の4桁目と5桁目（ただし30以下になるように調整） -->
		<!-- 連番: 定数の続く2桁 -->
    

    
	</div>
    
    <div class="sequence-container">
        <div id="ideology">To terminate anomalies, or to maintain their permanent stasis when termination is not feasible.</div><h1 id="title">TCHO-TERMINAL SYSTEM</h1><h2 id="access-level" class="hidden">LEVEL-5 UNLIMITED ACCESS</h2><div id="password-window" class="hidden"><p id="password-text">ENTER PASSWORD:</p><div id="password-squares"><div class="square"></div><div class="square"></div><div class="square"></div><div class="square"></div><div class="square"></div><div class="square"></div><div class="square"></div><div class="square"></div></div></div><p id="typewriter" class="hidden"></p>
    </div>

    <div class="main-grid hidden">
        <div class="grid-item top-left"><div id="clock-date"></div><div id="clock-time"></div></div>
        <div class="grid-item top-center"><input type="text" id="search-bar" placeholder="Search Database... (e.g., SAC-1990)"><div id="search-results" class="hidden"></div></div>
        <div class="grid-item top-right">
            <h2>ACCESS - MAIN DATABASE</h2><p class="read-only">READ-ONLY MODE</p><p>ISSUED BY: TCHO Top Priority Division<br>CLEARANCE: LEVEL-5 ZKK-ALL</p>
            <div class="session-info">
                <p>USER ID: <span>TCHO-ARUIHA.YORU</span></p><p>NODE: <span>TCHO-HQ-DEEP-01</span></p><p id="session-start-time"></p>
                <hr class="panel-divider">
                <div id="client-metadata"></div>
            </div>
            <div style="text-align:left; margin-top:5px;">
				<p class="session-info">SESSION-ID:<br><span style="color:#87CEFA">1 6180339887 4989484820</span></p>
				<p class="session-info">SIGNAL:<br><span style="color:#FF4F02">STRONG</span></p>
				<p class="session-info">ENCRYPTION-LEVEL:<br><span style="color:#FF0461">RED</span></p>
				<p class="session-info">CIPHER:<br><span style="color:#7FFFD4">4586834365 63811</span></p>
			</div>
			<!-- インライン要素長すぎ、汚い -->
            <div style="margin-top: 20px; margin-bottom: 20px;">
                <div style="display:flex;">
                  <div class="session-info" style="text-align: left; flex-grow: 1;">
                    <p style="display:flex; align-items: center;">DOA-01: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-02: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-03: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-04: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-05: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-06: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-07: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-08: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-09: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-10: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-11: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-12: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-13: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-14: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-15: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-16: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-17: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-18: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-19: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">DOA-20: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                  </div>
                  <div class="session-info" style="text-align: left; flex-grow: 1; padding-left:1.5rem">
                    <p style="display:flex; align-items: center;">KGN-R01: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-R02: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-R03: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-R04: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-R05: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-R06: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-W01: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-W02: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-W03: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-W04: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">KGN-W05: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-AD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-TPD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-SMD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-CID: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-SOD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-SD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-ASD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-FD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                    <p style="display:flex; align-items: center;">TCHO-LAD: <span style="color:springgreen; margin-left: auto;">●ACTIVE</span></p>
                  </div>
                </div>
            </div>
        </div>
        <div class="grid-item main-left">
            <div class="parallelograms" id="grade-parallelograms"></div>
            <div class="input-group"><label for="sac-number">SAC NUMBER:</label><input type="text" id="sac-number" readonly></div>
            <div class="input-group"><label for="series">SERIES:</label><input type="text" id="series" readonly></div>
            <div class="input-group"><label for="status">STATUS:</label><input type="text" id="status" readonly></div>
            <div class="input-group"><label for="assigned">ASSIGNED TO:</label><input type="text" id="assigned" readonly></div>
            <div class="input-group"><label for="modified">LAST MODIFIED:</label><input type="text" id="modified" readonly></div>
            <div class="input-group" id="binary-scroller-container">
                <label>DATA STREAM:</label>
                <div id="binary-scroller"></div>
            </div>
        </div>
        <div class="grid-item main-center"><div id="workspace"><pre id="text-content" class="hidden"></pre><iframe id="html-content" class="hidden" style="margin-top:5px;"></iframe></div></div>
        <div class="grid-item bottom-left">
            <div id="numeric-background"></div>
            <p>SYS-MSG: <span>// SECURE CONNECTION ESTABLISHED</span></p>
            <p id="ip-address"></p>
            <p id="connection-path"></p>
            <p>CONNECTION: <span>STABLE</span></p>
            <p>LAST BACKUP: <span>21:00:01.385</span></p>
            <p>ERROR LOG: <span>CLEAN</span></p>
            <p>DISK CHECK: <span>OK</span></p>
            <p id="hello-msg">HELLO.</p>
        </div>
        <div class="grid-item bottom-center"><div class="dock" id="dock-container"></div></div>
    </div>

<!-- javascriptはAI製多め -->
<script>
    const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));
    const backgroundLayerZ = document.getElementById('background-layer-z');
    const mainGrid = document.querySelector('.main-grid');
    const textContentEl = document.getElementById('text-content');
    const htmlContentEl = document.getElementById('html-content');
    const searchBar = document.getElementById('search-bar');
    const searchResults = document.getElementById('search-results');
    const dockContainer = document.getElementById('dock-container');
    const sacNumberInput = document.getElementById('sac-number');
    const seriesInput = document.getElementById('series');
    const statusInput = document.getElementById('status');
    const assignedInput = document.getElementById('assigned');
    const modifiedInput = document.getElementById('modified');
    const parallelogramsContainer = document.getElementById('grade-parallelograms');

    let _fileListData = []; 
    const gradeMapping = { '特級': 0, '準特級': 1, '一級': 2, '準一級': 3, '二級': 4, '準二級': 5, '三級': 6, '四級': 7 };
    const grades = Object.keys(gradeMapping);
    
    // --- AFK Mode Settings ---
    let afkTimer;
    let isAfkMode = false;
    const DEFAULT_AFK_TIMEOUT = 2000; // 20s
    const IFRAME_AFK_TIMEOUT = 5000; // 50s
    let currentAfkTimeout = DEFAULT_AFK_TIMEOUT;
    
    // --- Dynamic UI Data ---
    let lastTxid = BigInt(Math.floor(Date.now() / 1000)) * BigInt(1000);

    async function bootSequence() {
        const ideology = document.getElementById('ideology');
        const title = document.getElementById('title');
        const accessLevel = document.getElementById('access-level');
        const passwordWindow = document.getElementById('password-window');
        const passwordText = document.getElementById('password-text');
        const squares = document.querySelectorAll('.square');
        const typewriterEl = document.getElementById('typewriter');
        
        await sleep(500); ideology.style.opacity = 1; title.style.opacity = 1; await sleep(3000);
        ideology.style.transition = 'opacity 0.2s'; title.style.transition = 'opacity 0.2s';
        ideology.style.opacity = 0; title.style.opacity = 0; await sleep(300);
        accessLevel.classList.remove('hidden'); await sleep(10);
        accessLevel.style.opacity = 1; accessLevel.style.transform = 'scale(1.0)'; 
        
        await sleep(1500); 
        
        passwordWindow.classList.remove('hidden'); passwordWindow.classList.add('open');
        
        for (let i = 0; i < squares.length; i++) { 
            await sleep(50 + Math.random() * 100); 
            squares[i].classList.add('filled'); 
        }

        await sleep(100); passwordText.textContent = 'ACCEPTED.';
        passwordText.style.color = 'var(--color-blue-light)';
        squares.forEach(sq => sq.classList.add('accepted')); await sleep(1000);
        passwordWindow.classList.add('close'); accessLevel.style.opacity = 0; await sleep(500);
        passwordWindow.classList.add('hidden'); accessLevel.classList.add('hidden');
        typewriterEl.classList.remove('hidden');
        const typeWriter = (text, el) => new Promise(resolve => {
            el.style.opacity=1; let i=0; const interval = setInterval(() => {
            if (i < text.length) { el.textContent += text.charAt(i++); }
            else { clearInterval(interval); resolve(); }
        }, 50);});
        await typeWriter('> Welcome, authorized personnel.', typewriterEl); await sleep(1000);
        typewriterEl.style.opacity = 0; await sleep(500); typewriterEl.textContent = '';
        await typeWriter('> Please select your desired file.', typewriterEl); await sleep(1000);
        typewriterEl.style.opacity = 0; await sleep(500);
        
        document.body.classList.add('main-ui');
        mainGrid.classList.remove('hidden');
        backgroundLayerZ.classList.remove('hidden');
        
        mainGrid.style.transition = 'opacity 1.5s ease-in-out';
        backgroundLayerZ.style.transition = 'opacity 1.5s ease-in-out';
        await sleep(10);
        mainGrid.style.opacity = 1;
        backgroundLayerZ.style.opacity = 0.3;
        
        initializeMainUI();
        
        const sequenceContainer = document.querySelector('.sequence-container');
        if (sequenceContainer) sequenceContainer.remove();
    }

    function enterAfkMode() {
        if (!isAfkMode) {
            isAfkMode = true;
            mainGrid.style.transition = 'opacity 3.0s ease-in-out';
            backgroundLayerZ.style.transition = 'opacity 3.0s ease-in-out';
            mainGrid.style.opacity = '0';
            backgroundLayerZ.style.opacity = '1';
        }
    }
    
    function exitAfkMode() {
        if (isAfkMode) {
            isAfkMode = false;
            mainGrid.style.transition = 'opacity 0.5s ease-out';
            backgroundLayerZ.style.transition = 'opacity 0.5s ease-out';
            mainGrid.style.opacity = '1';
            backgroundLayerZ.style.opacity = '0.3';
        }
    }

    function resetAfkTimer() {
        if (isAfkMode) exitAfkMode();
        clearTimeout(afkTimer);
        afkTimer = setTimeout(enterAfkMode, currentAfkTimeout);
    }

    async function initializeMainUI() {
        startClock();
        generateDock();
        generateParallelograms();
        setupStaticInfo();
        startNumericBackground();
        startBinaryScroller();
        await fetchAndCacheFileList();
        setupEventListeners();
        resetAfkTimer();
    }
    
    function setupStaticInfo() {
        const ip3 = Math.floor(Math.random() * 256);
        const ip4 = Math.floor(Math.random() * 256);
        document.getElementById('ip-address').innerHTML = `IP ADDR: <span>10.45.${ip3}.${ip4}</span>`;
        
        const nodes = ['DEEP-NODE-01', 'RELAY-SIGMA-7', 'CORE-GATE-ALPHA'];
        const proxies = ['PROXY-4B', 'PROXY-9A', 'SEC-PROXY-3C'];
        const path = `TCHO-HQ > ${nodes[Math.floor(Math.random() * nodes.length)]} > ${proxies[Math.floor(Math.random() * proxies.length)]}`;
        document.getElementById('connection-path').innerHTML = `PATH: <span>${path}</span>`;
        
        const startTime = new Date().toLocaleTimeString('en-GB');
        document.getElementById('session-start-time').textContent = `SESSION START: ${startTime}`;

        const metadataContainer = document.getElementById('client-metadata');
        metadataContainer.innerHTML = `
            <p><span>PLATFORM:</span> ${navigator.platform}</p>
            <p><span>AGENT:</span> ${navigator.userAgent}</p>
            <p><span>LANGUAGE:</span> ${navigator.language}</p>
            <p><span>RESOLUTION:</span> ${screen.width}x${screen.height} @${screen.colorDepth}bit</p>
            <p><span>CPU CORES:</span> ${navigator.hardwareConcurrency || 'N/A'}</p>
            <p><span>MEMORY:</span> ${navigator.deviceMemory ? navigator.deviceMemory + 'GB' : 'N/A'}</p>
        `;
    }

    async function fetchAndCacheFileList() {
        try {
            const response = await fetch('./text/filelist.txt');
            if (!response.ok) throw new Error('Network response was not ok.');
            const text = await response.text();
            _fileListData = text.split('\n').map(f => f.trim()).filter(f => f.length > 0);
        } catch (error) { console.error('Failed to fetch filelist.txt:', error); }
    }

    function setupEventListeners() {
        window.addEventListener('mousemove', resetAfkTimer);
        window.addEventListener('keydown', resetAfkTimer);
        window.addEventListener('click', resetAfkTimer);
        dockContainer.addEventListener('click', (e) => { if (e.target.classList.contains('dock-item')) loadHtmlContent(e.target.getAttribute('data-path')); });
        searchBar.addEventListener('input', () => {
            const query = searchBar.value.toLowerCase();
            if (!query) { searchResults.classList.add('hidden'); return; }
            const filtered = _fileListData.filter(f => f.toLowerCase().includes(query));
            displaySearchResults(filtered);
        });
        searchResults.addEventListener('click', (e) => {
            if (e.target.classList.contains('search-result-item')) {
                const filename = e.target.getAttribute('data-filename');
                loadTextContent(filename);
                searchResults.classList.add('hidden');
                searchBar.value = '';
            }
        });
        document.addEventListener('click', (e) => { if (!searchResults.contains(e.target) && e.target !== searchBar) searchResults.classList.add('hidden'); });
    }

    function startClock() {
        const dateEl = document.getElementById('clock-date');
        const timeEl = document.getElementById('clock-time');
        const updateClock = () => {
            const now = new Date();
            const dateOptions = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
            dateEl.textContent = now.toLocaleDateString('en-US', dateOptions) + ' GMT+0900';
            timeEl.textContent = now.toLocaleTimeString('en-GB', { hour12: false }) + '.' + String(now.getMilliseconds()).padStart(3, '0');
        };
        setInterval(updateClock, 50);
    }
    
    // This function is commented out as it caused errors in the original file.
    // function startDbSyncMonitor() {
    //     const lagEl = document.getElementById('db-lag');
    //     const txidEl = document.getElementById('db-txid');
    //     const heartbeatEl = document.getElementById('db-heartbeat');
    //     setInterval(() => {
    //         lagEl.textContent = (Math.random() * 5 + 0.5).toFixed(3);
    //         lastTxid += BigInt(Math.floor(Math.random() * 10) + 1);
    //         txidEl.textContent = lastTxid.toString(16).toUpperCase();
    //         heartbeatEl.textContent = (Math.random() * 80 + 20).toFixed(0);
    //     }, 750);
    // }
    
    function startNumericBackground() {
        const bgEl = document.getElementById('numeric-background');
        const chars = '0123456789';
        const generateRandomString = (length) => {
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        };
        setInterval(() => {
            bgEl.textContent = generateRandomString(500); // Generate enough characters to fill the area
        }, 200);
    }
    
    // NEW: Function for the binary scroller animation
    function startBinaryScroller() {
        const scrollerEl = document.getElementById('binary-scroller');
        if (!scrollerEl) return;
        const chars = '01';
        let content = '';

        // Pre-fill with random binary content
        for (let i = 0; i < 2000; i++) { // Generate a large string
            content += chars.charAt(Math.floor(Math.random() * chars.length));
            if (i % 30 === 29) content += '\n'; // Add line breaks
        }
        
        let position = 0;
        setInterval(() => {
            // Take a slice of the long string to display
            const viewableContent = content.substring(position, position + 500);
            scrollerEl.textContent = viewableContent;
            position++;
            if (position > content.length - 500) {
                position = 0; // Loop back to the start
            }
        }, 100);
    }

    function displaySearchResults(files) {
        searchResults.innerHTML = '';
        if (files.length > 0) {
            searchResults.classList.remove('hidden');
            files.forEach(file => { const item = document.createElement('div'); item.className = 'search-result-item'; item.textContent = file; item.setAttribute('data-filename', file); searchResults.appendChild(item); });
        } else { searchResults.classList.add('hidden'); }
    }

    function loadHtmlContent(path) {
        textContentEl.classList.add('hidden');
        htmlContentEl.classList.remove('hidden');
        htmlContentEl.src = path;
        resetSideUI();
        currentAfkTimeout = IFRAME_AFK_TIMEOUT;
        resetAfkTimer();
    }
    
    async function loadTextContent(filename) {
        htmlContentEl.classList.add('hidden');
        textContentEl.classList.remove('hidden');
        currentAfkTimeout = DEFAULT_AFK_TIMEOUT;
        resetAfkTimer();
        try {
            const response = await fetch(`./text/${filename}`);
            if (!response.ok) throw new Error(`File not found: ${filename}`);
            const content = await response.text();
            updateUIWithFileData(filename, content);
        } catch (error) {
            console.error('Error loading file content:', error);
            textContentEl.textContent = `Error: Could not load file "${filename}".\n\n${error}`;
            resetSideUI();
        }
    }
    
    function generateMetadataFromFilename(filename) {
        const numbers = (filename.match(/\d+/g) || []).map(Number);
        if (numbers.length < 4) return {};
        const sum = numbers.reduce((acc, num) => acc + num, 0);

        const statusOptions = ['TERMINATED', 'CONTAINED', 'ACTIVE', 'MISSING', 'PENDING ANALYSIS', 'ARCHIVED'];
        const assignedOptions = ['DOA-11', 'DOA-08 / SCC-02', 'KGN-01', 'CID-TSK', 'ITC-04', 'UNASSIGNED', 'DOA-13'];

        const status = statusOptions[sum % statusOptions.length];
        const assigned = assignedOptions[(sum + numbers[0]) % assignedOptions.length];
        
        const baseDate = new Date(numbers[0], numbers[1] - 1, numbers[2]);
        const daysToAdd = sum % (365 * 10);
        baseDate.setDate(baseDate.getDate() + daysToAdd);
        const lastModified = baseDate.toISOString().split('T')[0];
        
        return { status, assigned, lastModified };
    }

    function updateUIWithFileData(filename, content) {
        const lines = content.split('\n');
        sacNumberInput.value = lines[0] ? lines[0].trim() : '';
        seriesInput.value = lines[1] ? lines[1].trim() : '';
        textContentEl.textContent = content;

        const generatedMeta = generateMetadataFromFilename(filename);
        statusInput.value = generatedMeta.status || 'N/A';
        assignedInput.value = generatedMeta.assigned || 'N/A';
        modifiedInput.value = generatedMeta.lastModified || 'N/A';
        
        const gradeLine = lines[2] || '';
        const match = gradeLine.match(/／\s*(.+?)\s*$/);
        const grade = match ? match[1] : null;
        highlightParallelogram(grade);
    }

    function highlightParallelogram(grade) {
        document.querySelectorAll('.parallelogram').forEach(p => p.classList.remove('highlighted'));
        if (grade && gradeMapping.hasOwnProperty(grade)) {
            const target = document.querySelector(`.parallelogram[data-grade="${grade}"]`);
            if (target) target.classList.add('highlighted');
        }
    }

    function resetSideUI() {
        sacNumberInput.value = ''; seriesInput.value = '';
        statusInput.value = ''; assignedInput.value = ''; modifiedInput.value = '';
        document.querySelectorAll('.parallelogram').forEach(p => p.classList.remove('highlighted'));
    }

    function generateDock() {
        const files = [{ name: "UN-1999-12-31.html", path: "./page/UN-1999-12-31.html" }, { name: "UN-2007-07-07.html", path: "./page/UN-2007-07-07.html" }];
        dockContainer.innerHTML = '';
        files.forEach(file => { const item = document.createElement('div'); item.className = 'dock-item'; item.setAttribute('data-path', file.path); item.setAttribute('data-filename', file.name); dockContainer.appendChild(item); });
    }
    function generateParallelograms() {
        parallelogramsContainer.innerHTML = '';
        grades.forEach(grade => { const p = document.createElement('div'); p.className = 'parallelogram'; p.setAttribute('data-grade', grade); const text = document.createElement('span'); text.className = 'grade-text'; text.textContent = grade; p.appendChild(text); parallelogramsContainer.appendChild(p); });
    }

    window.onload = bootSequence;
</script>
</body>
</html>